var ASSETS_PATH="https://s3-us-west-2.amazonaws.com/s.cdpn.io/122460/",DEFAULT="default",IMAGE_SD="sd",IMAGE_HD="hd",COLOR_WHITE=16777215,COLOR_BLACK=0,Utils={windowRatio:function(){return window.innerWidth/window.innerHeight}},Renderer=function(){var e=function(){var e=this,t=function(){return{webGLRenderer:{antialias:!1,alpha:!0,clearColor:COLOR_BLACK,canvasId:"canvas-earth"}}},a=t();this.init=function(){this.keepCurrentAntialias(),this.webGLRenderer=new THREE.WebGLRenderer({antialias:a.webGLRenderer.antialias,alpha:a.webGLRenderer.alpha}),this.webGLRenderer.setClearColor(a.webGLRenderer.clearColor),this.webGLRenderer.setPixelRatio(window.devicePixelRatio),this.webGLRenderer.domElement.id=a.webGLRenderer.canvasId,this.renderView()},this.refresh=function(e){if(this.setParamAntialias(e),!this.isAntialiasNotChanging()){this.keepCurrentAntialias();var t=document.getElementById(a.webGLRenderer.canvasId);document.body.removeChild(t),this.init(),Scene.activeOrbitControls(),SceneShadow.activeWebGLRendererShadowMap()}},this.setParamAntialias=function(e){a.webGLRenderer.antialias=e||t().webGLRenderer.antialias},this.keepCurrentAntialias=function(){a.webGLRenderer.previousAntialias=a.webGLRenderer.antialias},this.isAntialiasNotChanging=function(){return a.webGLRenderer.antialias===a.webGLRenderer.previousAntialias},this.renderView=function(){this.view=document.body,this.view.appendChild(this.webGLRenderer.domElement),this.updateSize()},this.updateSize=function(){this.webGLRenderer.setSize(window.innerWidth,window.innerHeight)},this.gui={reset:function(){e.refresh()},add:function(t){var i=t.addFolder("RENDERER");i.add(a.webGLRenderer,"antialias").listen().onChange(function(t){e.refresh(t)})}},this.init()};return new e}(),Camera=function(){var e=function(){var e=this,t=function(){return{perspectiveCamera:{positionX:0,positionY:0,positionZ:150,fov:63,near:1,far:8e3}}},a=t();this.init=function(){this.perspectiveCamera=new THREE.PerspectiveCamera(a.perspectiveCamera.fov,Utils.windowRatio(),a.perspectiveCamera.near,a.perspectiveCamera.far),this.perspectiveCamera.position.set(a.perspectiveCamera.positionX,a.perspectiveCamera.positionY,a.perspectiveCamera.positionZ)},this.updateAspect=function(){this.perspectiveCamera.aspect=Utils.windowRatio(),this.perspectiveCamera.updateProjectionMatrix()},this.updateLookAt=function(e){this.perspectiveCamera.lookAt(e)},this.gui={params:{colors:{}},reset:function(){var a=t();e.perspectiveCamera.fov=a.perspectiveCamera.fov,e.perspectiveCamera.near=a.perspectiveCamera.near,e.perspectiveCamera.far=a.perspectiveCamera.far,e.updateAspect()},add:function(t){var a=t.addFolder("CAMERA");return a.add(e.perspectiveCamera,"fov",0,150).listen().onChange(function(){e.updateAspect()}),a.add(e.perspectiveCamera,"near",0,5).listen().onChange(function(){e.updateAspect()}),a.add(e.perspectiveCamera,"far",0,1e4).listen().onChange(function(){e.updateAspect()}),a.add(this,"reset").name("RESET CAMERA"),a}},this.init()};return new e}(),Skymap=function(){var e=function(){var e=this,t=function(){return{imgDef:IMAGE_HD,imgDefPrevious:void 0,cubeTextureLoader:{positionTag:"{pos}",positions:["posx","negx","posy","negy","posz","negz"],filename:{sd:"skymap_{pos}_512x512.jpg",hd:"skymap_{pos}_1024x1024.jpg"}}}},a=t();this.init=function(){},this.setParamImgDef=function(e){a.imgDef=e||t().imgDef},this.setSceneBgCubeTexture=function(e,t){this.setParamImgDef(t),this.doesRefreshTextureNecessary()&&(e.background=this.getCubeTextureLoader(),this.disableRefreshTexture())},this.getCubeTextureLoader=function(){return(new THREE.CubeTextureLoader).setPath(ASSETS_PATH).load(this.getFilenames())},this.getFilenames=function(){for(var e=[],t=0;t<a.cubeTextureLoader.positions.length;t++)e.push(this.getFilename(a.cubeTextureLoader.positions[t]));return e},this.getFilename=function(e){return a.cubeTextureLoader.filename[a.imgDef].replace(a.cubeTextureLoader.positionTag,e)},this.doesRefreshTextureNecessary=function(){return a.imgDef!==a.imgDefPrevious},this.disableRefreshTexture=function(){a.imgDefPrevious=a.imgDef},this.gui={params:{},reset:function(){var a=t();e.setSceneBgCubeTexture(Scene.scene,a.imgDef)},add:function(t){var i=t.addFolder("SKYMAP");return i.add(a,"imgDef",[IMAGE_SD,IMAGE_HD]).listen().onChange(function(t){e.setSceneBgCubeTexture(Scene.scene,t)}),i.add(this,"reset").name("RESET SKYMAP"),i}},this.init()};return new e}(),Cloud=function(){var e=function(){var e=this,t=function(){return{imgDef:IMAGE_SD,imgDefPrevious:void 0,visible:!0,material:{wireframe:!1,transparent:!0,color:COLOR_WHITE,bumpScale:.13,opacity:.9,alphaMap:{sd:ASSETS_PATH+"earth_clouds_1024x512.jpg",hd:ASSETS_PATH+"earth_clouds_2048x1024.jpg"},bumpMap:{sd:ASSETS_PATH+"earth_clouds_1024x512.jpg",hd:ASSETS_PATH+"earth_clouds_2048x1024.jpg"}},geometry:{radius:50.3,widthSegments:64,heightSegments:32},animate:{enabled:!0,rotationsYPerSecond:-.0012}}},a=t();this.init=function(){this.material=new THREE.MeshPhongMaterial({wireframe:a.material.wireframe,color:a.material.color,opacity:a.material.opacity,transparent:a.material.transparent,bumpScale:a.material.bumpScale}),this.setMaterialTextures(),this.geometry=new THREE.SphereGeometry(a.geometry.radius,a.geometry.widthSegments,a.geometry.heightSegments),this.cloudMesh=new THREE.Mesh(this.geometry,this.material),this.cloudMesh.visible=a.visible},this.animate=function(e){a.animate.enabled&&(this.cloudMesh.rotation.y+=2*e*Math.PI*a.animate.rotationsYPerSecond)},this.setParamImgDef=function(e){a.imgDef=e||t().imgDef},this.setMaterialTextures=function(e){this.setParamImgDef(e),this.doesRefreshTextureNecessary()&&(this.material.alphaMap=(new THREE.TextureLoader).load(a.material.alphaMap[a.imgDef]),this.material.bumpMap=(new THREE.TextureLoader).load(a.material.bumpMap[a.imgDef]),this.disableRefreshTexture())},this.doesRefreshTextureNecessary=function(){return a.imgDef!==a.imgDefPrevious},this.disableRefreshTexture=function(){a.imgDefPrevious=a.imgDef},this.gui={params:{colors:{}},reset:function(){var i=t();e.cloudMesh.visible=i.visible,e.material.wireframe=i.material.wireframe,e.material.transparent=i.material.transparent,e.material.opacity=i.material.opacity,e.material.bumpScale=i.material.bumpScale,e.material.color.setHex(i.material.color),a.animate.enabled=i.animate.enabled,a.animate.rotationsYPerSecond=i.animate.rotationsYPerSecond,e.setMaterialTextures(i.imgDef),this.resetColorsHexString()},resetColorsHexString:function(){this.params.colors.color="#"+e.material.color.getHexString()},add:function(t){this.resetColorsHexString();var i=t.addFolder("CLOUD");i.add(e.cloudMesh,"visible").listen();var s=i.addFolder("Material");s.add(a,"imgDef",[IMAGE_SD,IMAGE_HD]).listen().onChange(function(t){e.setMaterialTextures(t)}),s.add(e.material,"wireframe").listen(),s.add(e.material,"transparent").listen(),s.add(e.material,"opacity",0,1).listen(),s.add(e.material,"bumpScale",-1.5,1.5).listen(),s.addColor(this.params.colors,"color").listen().onChange(function(t){e.material.color.setHex(t.replace("#","0x"))});var n=i.addFolder("Animate");return n.add(a.animate,"enabled").listen(),n.add(a.animate,"rotationsYPerSecond",-2,2).listen(),i.add(this,"reset").name("RESET CLOUD"),i}},this.init()};return new e}(),Earth=function(e){var t=function(){var t=this,a=function(){return{imgDef:IMAGE_SD,imgDefPrevious:void 0,visible:!0,material:{wireframe:!1,map:{sd:ASSETS_PATH+"earth_map_1024x512.jpg",hd:ASSETS_PATH+"earth_map_2048x1024.jpg"},bumpMap:{sd:ASSETS_PATH+"earth_bump_1024x512.jpg",hd:ASSETS_PATH+"earth_bump_2048x1024.jpg"},bumpScale:.45,specularMap:{sd:ASSETS_PATH+"earth_specular_1024x512.jpg",hd:ASSETS_PATH+"earth_specular_2048x1024.jpg"},specular:2969248,shininess:6},geometry:{radius:50,widthSegments:64,heightSegments:32},animate:{enabled:!0,rotationsYPerSecond:.01}}},i=a();this.init=function(){this.geometry=new THREE.SphereGeometry(i.geometry.radius,i.geometry.widthSegments,i.geometry.heightSegments),this.material=new THREE.MeshPhongMaterial({wireframe:i.material.wireframe,bumpScale:i.material.bumpScale,specular:i.material.specular,shininess:i.material.shininess}),this.setMaterialTextures(),this.earthMesh=new THREE.Mesh(this.geometry,this.material),this.earthMesh.visible=i.visible,this.earthMesh.add(e.cloudMesh)},this.animate=function(e){i.animate.enabled&&(this.earthMesh.rotation.y+=2*e*Math.PI*i.animate.rotationsYPerSecond)},this.setParamImgDef=function(e){i.imgDef=e||a().imgDef},this.setMaterialTextures=function(e){this.setParamImgDef(e),this.doesRefreshTextureNecessary()&&(this.material.map=(new THREE.TextureLoader).load(i.material.map[i.imgDef]),this.material.bumpMap=(new THREE.TextureLoader).load(i.material.bumpMap[i.imgDef]),this.material.specularMap=(new THREE.TextureLoader).load(i.material.specularMap[i.imgDef]),this.disableRefreshTexture())},this.doesRefreshTextureNecessary=function(){return i.imgDef!==i.imgDefPrevious},this.disableRefreshTexture=function(){i.imgDefPrevious=i.imgDef},this.gui={params:{colors:{}},reset:function(){var e=a();t.earthMesh.visible=e.visible,t.material.wireframe=e.material.wireframe,t.material.bumpScale=e.material.bumpScale,t.material.shininess=e.material.shininess,t.material.specular.setHex(e.material.specular),i.animate.enabled=e.animate.enabled,i.animate.rotationsYPerSecond=e.animate.rotationsYPerSecond,t.setMaterialTextures(e.imgDef),this.resetColorsHexString()},resetColorsHexString:function(){this.params.colors.specular="#"+t.material.specular.getHexString()},add:function(e){this.resetColorsHexString();var a=e.addFolder("EARTH");a.add(t.earthMesh,"visible").listen();var s=a.addFolder("Material");s.add(i,"imgDef",[IMAGE_SD,IMAGE_HD]).listen().onChange(function(e){t.setMaterialTextures(e)}),s.add(t.material,"wireframe").listen(),s.add(t.material,"bumpScale",-1.5,1.5).listen(),s.add(t.material,"shininess",0,10).listen(),s.addColor(this.params.colors,"specular").listen().onChange(function(e){t.material.specular.setHex(e.replace("#","0x"))});var n=a.addFolder("Animate");return n.add(i.animate,"enabled").listen(),n.add(i.animate,"rotationsYPerSecond",-2,2).listen(),a.add(this,"reset").name("RESET EARTH"),a}},this.init()};return new t}(Cloud),Moon=function(e){var t=function(){var t=this,a=function(){return{imgDef:IMAGE_SD,imgDefPrevious:void 0,moonMesh:{visible:!0,position:{x:0,y:0,z:-100}},material:{wireframe:!1,map:{sd:ASSETS_PATH+"moon_map_512x256.jpg",hd:ASSETS_PATH+"moon_map_1024x512.jpg"},bumpMap:{sd:ASSETS_PATH+"moon_bump_512x256.jpg",hd:ASSETS_PATH+"moon_bump_1024x512.jpg"},bumpScale:.1,shininess:0},geometry:{radius:10,widthSegments:32,heightSegments:16},animate:{enabled:!0,pivotRotationsPerSecond:.05}}},i=a();this.init=function(){this.geometry=new THREE.SphereGeometry(i.geometry.radius,i.geometry.widthSegments,i.geometry.heightSegments),this.material=new THREE.MeshPhongMaterial({wireframe:i.material.wireframe,bumpScale:i.material.bumpScale,shininess:i.material.shininess}),this.setMaterialTextures(),this.moonMesh=new THREE.Mesh(this.geometry,this.material),this.moonMesh.position.set(i.moonMesh.position.x,i.moonMesh.position.y,i.moonMesh.position.z),this.moonMesh.visible=i.moonMesh.visible,this.pivot=this.createPivot()},this.createPivot=function(){var t=new THREE.Object3D;return t.position=e.earthMesh.position,t.add(this.moonMesh),t},this.animate=function(e){i.animate.enabled&&(this.pivot.rotation.y+=2*e*Math.PI*i.animate.pivotRotationsPerSecond)},this.setParamImgDef=function(e){i.imgDef=e||a().imgDef},this.setMaterialTextures=function(e){this.setParamImgDef(e),this.doesRefreshTextureNecessary()&&(this.material.map=(new THREE.TextureLoader).load(i.material.map[i.imgDef]),this.material.bumpMap=(new THREE.TextureLoader).load(i.material.bumpMap[i.imgDef]),this.disableRefreshTexture())},this.doesRefreshTextureNecessary=function(){return i.imgDef!==i.imgDefPrevious},this.disableRefreshTexture=function(){i.imgDefPrevious=i.imgDef},this.gui={params:{colors:{}},reset:function(){var e=a();t.moonMesh.visible=e.moonMesh.visible,t.material.wireframe=e.material.wireframe,t.material.bumpScale=e.material.bumpScale,t.material.shininess=e.material.shininess,t.moonMesh.position.x=e.moonMesh.position.x,t.moonMesh.position.y=e.moonMesh.position.y,t.moonMesh.position.z=e.moonMesh.position.z,i.animate.enabled=e.animate.enabled,i.animate.pivotRotationsPerSecond=e.animate.pivotRotationsPerSecond,t.setMaterialTextures(e.imgDef)},add:function(e){var a=e.addFolder("MOON");a.add(t.moonMesh,"visible").listen();var s=a.addFolder("Position");s.add(t.moonMesh.position,"x",-100,100).listen(),s.add(t.moonMesh.position,"y",-100,100).listen(),s.add(t.moonMesh.position,"z",-100,100).listen();var n=a.addFolder("Material");n.add(i,"imgDef",[IMAGE_SD,IMAGE_HD]).listen().onChange(function(e){t.setMaterialTextures(e)}),n.add(t.material,"wireframe").listen(),n.add(t.material,"bumpScale",-1.5,1.5).listen(),n.add(t.material,"shininess",0,10).listen();var r=a.addFolder("Animate");return r.add(i.animate,"enabled").listen(),r.add(i.animate,"pivotRotationsPerSecond",-2,2).listen(),a.add(this,"reset").name("RESET MOON"),a}},this.init()};return new t}(Earth),Sun=function(){var e=function(){var e=this,t=function(){return{imgDef:IMAGE_HD,imgDefPrevious:void 0,sunLight:{visible:!0,color:COLOR_WHITE,intensity:1.3,position:{x:-380,y:240,z:-1e3}},sunLensFlare:{textures:{sun:{sd:ASSETS_PATH+"lens_flare_sun_512x512.jpg",hd:ASSETS_PATH+"lens_flare_sun_1024x1024.jpg"},circle:{sd:ASSETS_PATH+"lens_flare_circle_32x32.jpg",hd:ASSETS_PATH+"lens_flare_circle_64x64.jpg"},hexagon:{sd:ASSETS_PATH+"lens_flare_hexagon_128x128.jpg",hd:ASSETS_PATH+"lens_flare_hexagon_256x256.jpg"}},flareCircleSizeMax:70,lensFlares:[{size:1400,opacity:1,distance:0},{size:20,opacity:.4,distance:.63},{size:40,opacity:.3,distance:.64},{size:70,opacity:.8,distance:.7},{size:110,opacity:.7,distance:.8},{size:60,opacity:.4,distance:.85},{size:30,opacity:.4,distance:.86},{size:120,opacity:.3,distance:.9},{size:260,opacity:.4,distance:1}]}}},a=t();this.init=function(){this.textureLoader=new THREE.TextureLoader,this.sunLight=new THREE.DirectionalLight(a.sunLight.color,a.sunLight.intensity),this.sunLight.position.set(a.sunLight.position.x,a.sunLight.position.y,a.sunLight.position.z),this.sunLight.visible=a.sunLight.visible,this.createLensFlare(),this.disableRefreshTexture()},this.setParamImgDef=function(e){a.imgDef=e||t().imgDef},this.createLensFlare=function(){this.sunLensFlare=this.getSunLensFlare(),this.sunLight.add(this.sunLensFlare)},this.getSunLensFlare=function(){this.loadLensFlareTextures();var e=new THREE.LensFlare(this.getTextureByIndex(0),a.sunLensFlare.lensFlares[0].size,a.sunLensFlare.lensFlares[0].distance,THREE.AdditiveBlending);return this.addLensFlareSunCirclesAndHexagons(e)},this.addLensFlareSunCirclesAndHexagons=function(e){for(var t=1;t<a.sunLensFlare.lensFlares.length;t++)e.add(this.getTextureByIndex(t),a.sunLensFlare.lensFlares[t].size,a.sunLensFlare.lensFlares[t].distance,THREE.AdditiveBlending);return e},this.getTextureByIndex=function(e){return 0===e?this.textureFlareSun:a.sunLensFlare.lensFlares[e].size<a.sunLensFlare.flareCircleSizeMax?this.textureFlareCircle:this.textureFlareHexagon},this.loadLensFlareTextures=function(){this.textureFlareSun=this.textureLoader.load(a.sunLensFlare.textures.sun[a.imgDef]),this.textureFlareCircle=this.textureLoader.load(a.sunLensFlare.textures.circle[a.imgDef]),this.textureFlareHexagon=this.textureLoader.load(a.sunLensFlare.textures.hexagon[a.imgDef])},this.refreshTextures=function(e){if(this.setParamImgDef(e),this.doesRefreshTextureNecessary()){this.loadLensFlareTextures();for(var t=0;t<a.sunLensFlare.lensFlares.length;t++)this.sunLensFlare.lensFlares[t].texture=this.getTextureByIndex(t);this.disableRefreshTexture()}},this.doesRefreshTextureNecessary=function(){return a.imgDef!==a.imgDefPrevious},this.disableRefreshTexture=function(){a.imgDefPrevious=a.imgDef},this.gui={params:{colors:{}},reset:function(){var i=t();e.sunLight.visible=i.sunLight.visible,e.sunLight.intensity=i.sunLight.intensity,e.sunLight.color.setHex(i.sunLight.color),e.sunLight.position.x=i.sunLight.position.x,e.sunLight.position.y=i.sunLight.position.y,e.sunLight.position.z=i.sunLight.position.z;for(var s=0;s<a.sunLensFlare.lensFlares.length;s++)e.sunLensFlare.lensFlares[s].size=i.sunLensFlare.lensFlares[s].size,e.sunLensFlare.lensFlares[s].opacity=i.sunLensFlare.lensFlares[s].opacity,e.sunLensFlare.lensFlares[s].distance=i.sunLensFlare.lensFlares[s].distance;this.resetColorsHexString(),e.refreshTextures()},resetColorsHexString:function(){this.params.colors.color="#"+e.sunLight.color.getHexString()},add:function(t){this.resetColorsHexString();var i=t.addFolder("SUN");i.add(e.sunLight,"visible").listen();var s=i.addFolder("Light");s.add(e.sunLight,"intensity",0,10).listen(),s.addColor(this.params.colors,"color").listen().onChange(function(t){e.sunLight.color.setHex(t.replace("#","0x"))});var n=i.addFolder("Position");n.add(e.sunLight.position,"x",-2e3,2e3).listen(),n.add(e.sunLight.position,"y",-2e3,2e3).listen(),n.add(e.sunLight.position,"z",-2e3,2e3).listen();var r=i.addFolder("LensFlares");r.add(a,"imgDef",[IMAGE_SD,IMAGE_HD]).listen().onChange(function(t){e.refreshTextures(t)});for(var o=0;o<e.sunLensFlare.lensFlares.length;o++)r.add(e.sunLensFlare.lensFlares[o],"size",0,2e3).name(o+". size").listen(),r.add(e.sunLensFlare.lensFlares[o],"opacity",0,1).name(o+". opacity").listen(),r.add(e.sunLensFlare.lensFlares[o],"distance",-1,1).name(o+". distance").listen();return i.add(this,"reset").name("RESET SUN"),i}},this.init()};return new e}(),Scene=function(){var e=function(){var e=this,t=function(){return{orbitControls:{autoRotate:!0,autoRotateSpeed:.07}}},a=t();this.init=function(){this.scene=new THREE.Scene,this.scene.add(Earth.earthMesh),this.scene.add(Moon.pivot),this.scene.add(Sun.sunLight),Skymap.setSceneBgCubeTexture(this.scene),this.activeOrbitControls()},this.activeOrbitControls=function(){this.orbitControls=new THREE.OrbitControls(Camera.perspectiveCamera,Renderer.webGLRenderer.domElement),this.applyParamsOrbitControlsAutoRotate(),this.applyParamsOrbitControlsAutoRotateSpeed(),this.orbitControls.enableDamping=!0},this.applyParamsOrbitControlsAutoRotate=function(){this.orbitControls.autoRotate=a.orbitControls.autoRotate},this.applyParamsOrbitControlsAutoRotateSpeed=function(){this.orbitControls.autoRotateSpeed=a.orbitControls.autoRotateSpeed},this.refreshOrbitControls=function(){this.activeOrbitControls(),this.gui.reset()},this.gui={params:{colors:{}},reset:function(){var i=t();a.orbitControls.autoRotate=i.orbitControls.autoRotate,a.orbitControls.autoRotateSpeed=i.orbitControls.autoRotateSpeed,e.applyParamsOrbitControlsAutoRotate(),e.applyParamsOrbitControlsAutoRotateSpeed()},add:function(t){var i=t.addFolder("ORBIT CONTROLS");return i.add(a.orbitControls,"autoRotate").listen().onChange(function(t){e.applyParamsOrbitControlsAutoRotate()}),i.add(a.orbitControls,"autoRotateSpeed",-1,1).listen().onChange(function(t){e.applyParamsOrbitControlsAutoRotateSpeed()}),i.add(this,"reset").name("RESET CONTR."),i}},this.init()};return new e}(),SceneShadow=function(e){var t=function(){var t=this,a=function(){return{cameraHelper:{visible:!1},shadow:{castShadow:!0,camera:{near:950,far:1250,right:150,left:-150,top:150,bottom:-150},mapSize:{width:512,height:512},bias:0}}},i=a();this.init=function(){this.setShadowConfiguration()},this.setShadowConfiguration=function(){this.cameraHelper=new THREE.CameraHelper(Sun.sunLight.shadow.camera),e.scene.add(this.cameraHelper),this.cameraHelper.visible=i.cameraHelper.visible,Sun.sunLight.castShadow=i.shadow.castShadow,Sun.sunLight.shadow.camera.near=i.shadow.camera.near,Sun.sunLight.shadow.camera.far=i.shadow.camera.far,Sun.sunLight.shadow.mapSize.width=i.shadow.mapSize.width,Sun.sunLight.shadow.mapSize.height=i.shadow.mapSize.height,Sun.sunLight.shadow.bias=i.shadow.bias,Sun.sunLight.shadow.camera.right=i.shadow.camera.right,Sun.sunLight.shadow.camera.left=i.shadow.camera.left,Sun.sunLight.shadow.camera.top=i.shadow.camera.top,Sun.sunLight.shadow.camera.bottom=i.shadow.camera.bottom,Earth.earthMesh.castShadow=!0,Earth.earthMesh.receiveShadow=!0,Cloud.cloudMesh.receiveShadow=!0,Moon.moonMesh.castShadow=!0,Moon.moonMesh.receiveShadow=!0,this.activeWebGLRendererShadowMap(),this.updateShadow()},this.activeWebGLRendererShadowMap=function(){Renderer.webGLRenderer.shadowMap.enabled=!0,Renderer.webGLRenderer.shadowMap.type=THREE.PCFSoftShadowMap,Renderer.webGLRenderer.shadowMapSoft=!0},this.updateShadow=function(){Sun.sunLight.shadow.camera.updateProjectionMatrix(),this.cameraHelper.update()},this.gui={params:{colors:{}},reset:function(){var e=a();Sun.sunLight.castShadow=e.shadow.castShadow,Sun.sunLight.shadow.camera.near=e.shadow.camera.near,Sun.sunLight.shadow.camera.far=e.shadow.camera.far,Sun.sunLight.shadow.mapSize.width=e.shadow.mapSize.width,Sun.sunLight.shadow.mapSize.height=e.shadow.mapSize.height,Sun.sunLight.shadow.bias=e.shadow.bias,Sun.sunLight.shadow.camera.right=e.shadow.camera.right,Sun.sunLight.shadow.camera.left=e.shadow.camera.left,Sun.sunLight.shadow.camera.top=e.shadow.camera.top,Sun.sunLight.shadow.camera.bottom=e.shadow.camera.bottom,t.updateShadow()},add:function(e){var a=e.addFolder("SHADOW");return a.add(t.cameraHelper,"visible").name("cameraHelper").listen(),a.add(Sun.sunLight,"castShadow").listen(),a.add(Sun.sunLight.shadow.camera,"near").step(10).listen().onChange(function(){t.updateShadow()}),a.add(Sun.sunLight.shadow.camera,"far").step(10).listen().onChange(function(){t.updateShadow()}),a.add(Sun.sunLight.shadow.mapSize,"width",0,2048).listen(),a.add(Sun.sunLight.shadow.mapSize,"height",0,2048).listen(),a.add(Sun.sunLight.shadow,"bias",0,.4).step(.001).listen().onChange(function(){t.updateShadow()}),a.add(Sun.sunLight.shadow.camera,"right").step(10).listen().onChange(function(){t.updateShadow()}),a.add(Sun.sunLight.shadow.camera,"left").step(10).listen().onChange(function(){t.updateShadow()}),a.add(Sun.sunLight.shadow.camera,"top").step(10).listen().onChange(function(){t.updateShadow()}),a.add(Sun.sunLight.shadow.camera,"bottom").step(10).listen().onChange(function(){t.updateShadow()}),a.add(this,"reset").name("RESET SHADOW"),a}},this.init()};return new t}(Scene),View=function(){var e,t,a={imgDef:DEFAULT,helpClassname:"help"},i=function(){this.init=function(){e=new THREE.Clock,this.updateAll(),this.addGui(),this.help(),i(),window.addEventListener("resize",this.updateAll,!1)},this.addGui=function(){var e=new dat.GUI;Scene.gui.add(e),Camera.gui.add(e),Skymap.gui.add(e),Sun.gui.add(e),folderEarth=Earth.gui.add(e),Cloud.gui.add(folderEarth),Moon.gui.add(e),SceneShadow.gui.add(e),Renderer.gui.add(e),e.add(a,"imgDef",[DEFAULT,IMAGE_SD,IMAGE_HD]).name("IMG DEF ALL").listen().onChange(function(e){e=DEFAULT===e?void 0:e,Sun.refreshTextures(e),Skymap.setSceneBgCubeTexture(Scene.scene,e),Earth.setMaterialTextures(e),Cloud.setMaterialTextures(e),Moon.setMaterialTextures(e)}),e.add(this,"resetAll").name("RESET ALL"),e.add(this,"help").name("(?) HELP")},this.resetAll=function(){a.imgDef=DEFAULT,Renderer.gui.reset(),Scene.gui.reset(),Camera.gui.reset(),Skymap.gui.reset(),Sun.gui.reset(),Earth.gui.reset(),Cloud.gui.reset(),Moon.gui.reset(),SceneShadow.gui.reset()},this.updateAll=function(){Camera.updateAspect(),Renderer.updateSize()},this.help=function(){var e=document.getElementsByClassName(a.helpClassname)[0].style;e.display=this.helpHideToggle(e.display)},this.helpHideToggle=function(e){return"none"===e?"block":"none"};var i=function(){requestAnimationFrame(i),t=e.getDelta(),Earth.animate(t),Cloud.animate(t),Moon.animate(t),Scene.orbitControls.update(),Renderer.webGLRenderer.render(Scene.scene,Camera.perspectiveCamera)};this.init()};return new i}();